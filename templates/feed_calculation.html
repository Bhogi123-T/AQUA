{% extends "layout.html" %}

{% block content %}
<div class="app-card">
    <span class="app-emoji">ğŸ½ï¸</span>
    <h2 style="font-size: 3rem; font-weight: 900; margin-bottom: 1rem;">{{ trans['feed_title'] | safe }}</h2>
    <p style="color: var(--text-muted); margin-bottom: 3.5rem; font-size: 1.2rem;">{{ trans['feed_desc'] }}</p>

    <div
        style="background: rgba(0, 255, 136, 0.05); padding: 1.5rem; border-radius: 1.5rem; margin-bottom: 2.5rem; border: 1px dashed var(--accent); display: flex; align-items: center; justify-content: space-between;">
        <div style="text-align: left;">
            <p style="margin:0; font-weight: 800; color: var(--accent);">ğŸ“¡ LIVE TEMPERATURE AVAILABLE</p>
            <p style="margin:0; font-size: 0.8rem; color: var(--text-muted);">Current pond sensor: <span
                    id="sync-temp-val">--</span>Â°C</p>
        </div>
        <button type="button" onclick="syncFeedTemp()" class="app-btn-small"
            style="background: var(--accent); color: #000; padding: 10px 20px; border-radius: 1rem; border:none; font-weight: 900; cursor: pointer; transition: all 0.3s;">âš¡
            SYNC TEMP</button>
    </div>

    <form action="/predict_feed" method="POST" class="app-form" id="feed-form">
        <div class="app-input-group">
            <span class="app-label">{{ trans['species'] }}</span>
            <select name="species" class="app-input">
                {% for spec in species_list %}
                <option value="{{ spec.id }}">{{ spec.display }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="app-input-group">
            <span class="app-label">{{ trans['age'] }} ({{ trans['days'] }})</span>
            <input type="number" name="age" class="app-input" placeholder="e.g. 60" required>
        </div>

        <div class="app-input-group">
            <span class="app-label">{{ trans['avg_temp'] }} (Â°C)</span>
            <input type="number" step="0.1" name="temp" id="feed-temp-input" class="app-input" placeholder="e.g. 27"
                required>
        </div>

        <div class="app-input-group">
            <span class="app-label">{{ trans['feed_type'] }}</span>
            <select name="feed_type" class="app-input">
                <option value="Pellet">{{ trans['feed_pellet'] }}</option>
                <option value="Floating">{{ trans['feed_floating'] }}</option>
                <option value="Sinking">{{ trans['feed_sinking'] }}</option>
            </select>
        </div>

        <div class="app-input-group">
            <span class="app-label">ğŸ“Š Display Unit</span>
            <select name="unit_preference" class="app-input" id="feed-unit-pref">
                <option value="kg" selected>Kilograms (kg)</option>
                <option value="grams">Grams (g)</option>
                <option value="tons">Metric Tons (MT)</option>
                <option value="pounds">Pounds (lbs)</option>
            </select>
        </div>

        <button class="app-btn-large">ğŸ½ï¸ {{ trans['btn_calc'] }}</button>
    </form>

    <script>
        function syncFeedTemp() {
            const btn = event.target;
            btn.innerText = "â³ SYNCING...";
            fetch('/api/realtime')
                .then(res => res.json())
                .then(data => {
                    document.getElementById('feed-temp-input').value = data.temp;
                    document.getElementById('sync-temp-val').innerText = data.temp;
                    btn.innerText = "âœ… SYNCED";
                    setTimeout(() => { btn.innerText = "âš¡ SYNC TEMP"; }, 2000);
                });
        }
    </script>

    <div style="margin-top: 4rem;">
        <a href="/farmer?lang={{ lang }}"
            style="color: var(--text-muted); text-decoration: none; font-weight: 800; font-size: 1.4rem; transition: color 0.3s;">
            ğŸ”™ {{ trans['back'] }}
        </a>
    </div>
</div>
{% endblock %}